<!doctype html>
<html lang="ru">
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>üîí AI Security Test Assistant</title>
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap');
		
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		
		body {
			font-family: 'Share Tech Mono', 'Courier New', monospace;
			background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
			color: #00ff88;
			min-height: 100vh;
			padding: 20px;
			position: relative;
			overflow-x: hidden;
		}
		
		body::before {
			content: '';
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: 
				radial-gradient(circle at 20% 50%, rgba(0, 255, 136, 0.1) 0%, transparent 50%),
				radial-gradient(circle at 80% 80%, rgba(138, 43, 226, 0.1) 0%, transparent 50%),
				radial-gradient(circle at 40% 20%, rgba(0, 191, 255, 0.1) 0%, transparent 50%);
			pointer-events: none;
			z-index: 0;
		}
		
		.container {
			max-width: 1400px;
			margin: 0 auto;
			position: relative;
			z-index: 1;
		}
		
		header {
			text-align: center;
			margin-bottom: 40px;
			padding: 30px;
			background: rgba(0, 0, 0, 0.5);
			border: 2px solid #00ff88;
			border-radius: 10px;
			box-shadow: 0 0 30px rgba(0, 255, 136, 0.3), inset 0 0 30px rgba(0, 255, 136, 0.1);
			position: relative;
			overflow: hidden;
		}
		
		header::before {
			content: 'üîí';
			position: absolute;
			top: 10px;
			left: 20px;
			font-size: 2em;
			animation: pulse 2s infinite;
		}
		
		header::after {
			content: 'üõ°Ô∏è';
			position: absolute;
			top: 10px;
			right: 20px;
			font-size: 2em;
			animation: pulse 2s infinite 1s;
		}
		
		@keyframes pulse {
			0%, 100% { opacity: 1; transform: scale(1); }
			50% { opacity: 0.7; transform: scale(1.1); }
		}
		
		h1 {
			font-family: 'Orbitron', sans-serif;
			font-size: 2.5em;
			font-weight: 900;
			background: linear-gradient(90deg, #00ff88, #00d4ff, #8a2be2);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			text-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
			margin-bottom: 10px;
			letter-spacing: 3px;
		}
		
		.subtitle {
			color: #00d4ff;
			font-size: 1.1em;
			letter-spacing: 2px;
		}
		
		section {
			background: rgba(0, 0, 0, 0.6);
			border: 1px solid #00ff88;
			border-radius: 8px;
			padding: 25px;
			margin-bottom: 30px;
			box-shadow: 0 0 20px rgba(0, 255, 136, 0.2), inset 0 0 20px rgba(0, 255, 136, 0.05);
			position: relative;
		}
		
		section::before {
			content: '';
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			height: 3px;
			background: linear-gradient(90deg, transparent, #00ff88, transparent);
			animation: scan 3s linear infinite;
		}
		
		@keyframes scan {
			0% { transform: translateX(-100%); }
			100% { transform: translateX(100%); }
		}
		
		h2, h3 {
			font-family: 'Orbitron', sans-serif;
			color: #00d4ff;
			margin-bottom: 20px;
			font-weight: 700;
			text-transform: uppercase;
			letter-spacing: 2px;
			display: flex;
			align-items: center;
			gap: 10px;
		}
		
		h2::before, h3::before {
			content: '‚ñ∂';
			color: #00ff88;
			font-size: 0.8em;
		}
		
		label {
			display: block;
			color: #00d4ff;
			margin-bottom: 8px;
			font-weight: bold;
			text-transform: uppercase;
			font-size: 0.9em;
			letter-spacing: 1px;
		}
		
		input, textarea, select {
			width: 100%;
			padding: 12px;
			background: rgba(0, 0, 0, 0.7);
			border: 2px solid #00ff88;
			border-radius: 5px;
			color: #00ff88;
			font-family: 'Share Tech Mono', monospace;
			font-size: 14px;
			margin-bottom: 15px;
			transition: all 0.3s;
		}
		
		input:focus, textarea:focus, select:focus {
			outline: none;
			border-color: #00d4ff;
			box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
			background: rgba(0, 0, 0, 0.9);
		}
		
		textarea {
			resize: vertical;
			min-height: 120px;
		}
		
		button {
			padding: 12px 24px;
			background: linear-gradient(135deg, #00ff88, #00d4ff);
			border: none;
			border-radius: 5px;
			color: #0a0e27;
			font-family: 'Orbitron', sans-serif;
			font-weight: 700;
			font-size: 14px;
			cursor: pointer;
			text-transform: uppercase;
			letter-spacing: 1px;
			transition: all 0.3s;
			position: relative;
			overflow: hidden;
			margin: 5px;
			box-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
		}
		
		button::before {
			content: '';
			position: absolute;
			top: 50%;
			left: 50%;
			width: 0;
			height: 0;
			border-radius: 50%;
			background: rgba(255, 255, 255, 0.3);
			transform: translate(-50%, -50%);
			transition: width 0.6s, height 0.6s;
		}
		
		button:hover::before {
			width: 300px;
			height: 300px;
		}
		
		button:hover {
			transform: translateY(-2px);
			box-shadow: 0 5px 25px rgba(0, 255, 136, 0.6);
		}
		
		button:active {
			transform: translateY(0);
		}
		
		button.secondary {
			background: linear-gradient(135deg, #8a2be2, #ff00ff);
			box-shadow: 0 0 15px rgba(138, 43, 226, 0.4);
		}
		
		button.secondary:hover {
			box-shadow: 0 5px 25px rgba(138, 43, 226, 0.6);
		}
		
		.row {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 25px;
		}
		
		@media (max-width: 968px) {
			.row {
				grid-template-columns: 1fr;
			}
		}
		
		#cases {
			list-style: none;
			margin-top: 20px;
		}
		
		#cases li {
			background: rgba(0, 255, 136, 0.1);
			border: 1px solid #00ff88;
			border-radius: 5px;
			padding: 15px;
			margin-bottom: 15px;
			transition: all 0.3s;
		}
		
		#cases li:hover {
			background: rgba(0, 255, 136, 0.2);
			box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
			transform: translateX(5px);
		}
		
		#cases li strong {
			color: #00d4ff;
			font-size: 1.1em;
			display: block;
			margin-bottom: 10px;
		}
		
		#cases li em {
			color: #8a2be2;
			font-style: normal;
			font-weight: bold;
		}
		
		pre {
			background: rgba(0, 0, 0, 0.8);
			border: 2px solid #00ff88;
			border-radius: 5px;
			padding: 20px;
			overflow: auto;
			max-height: 400px;
			color: #00ff88;
			font-family: 'Share Tech Mono', monospace;
			font-size: 13px;
			line-height: 1.6;
			position: relative;
		}
		
		pre::before {
			content: 'üìä';
			position: absolute;
			top: 10px;
			right: 10px;
			font-size: 1.5em;
		}
		
		code {
			white-space: pre-wrap;
			color: #00ff88;
		}
		
		.input-group {
			display: flex;
			gap: 10px;
			align-items: center;
			margin-bottom: 15px;
		}
		
		.input-group label {
			margin-bottom: 0;
			white-space: nowrap;
		}
		
		.input-group input, .input-group select {
			margin-bottom: 0;
		}
		
		.status-indicator {
			display: inline-block;
			width: 12px;
			height: 12px;
			border-radius: 50%;
			background: #00ff88;
			box-shadow: 0 0 10px #00ff88;
			animation: blink 2s infinite;
			margin-left: 10px;
		}
		
		@keyframes blink {
			0%, 100% { opacity: 1; }
			50% { opacity: 0.3; }
		}
		
		hr {
			border: none;
			height: 2px;
			background: linear-gradient(90deg, transparent, #00ff88, transparent);
			margin: 30px 0;
		}
		
		.alert {
			background: rgba(0, 255, 136, 0.2);
			border: 2px solid #00ff88;
			border-radius: 5px;
			padding: 15px;
			margin: 15px 0;
			color: #00ff88;
			font-weight: bold;
		}
	</style>
	<script>
		const API_BASE = (location.port && location.port !== '80') ? `http://localhost:8000` : '';
		let templates = [];
		
		// –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
		async function loadTemplates() {
			try {
				const res = await fetch(API_BASE + '/templates');
				const data = await res.json();
				templates = data.templates || [];
				const templateSelect = document.getElementById('template');
				if (templateSelect) {
					templateSelect.innerHTML = '<option value="">–ë–µ–∑ —à–∞–±–ª–æ–Ω–∞ (—Ä—É—á–Ω–æ–π –≤–≤–æ–¥)</option>';
					templates.forEach(t => {
						const option = document.createElement('option');
						option.value = t.name;
						option.textContent = `${t.name} - ${t.description}`;
						templateSelect.appendChild(option);
					});
				}
			} catch (error) {
				console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤:', error);
			}
		}
		
		// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —à–∞–±–ª–æ–Ω–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
		function updateTemplateParams() {
			const templateName = document.getElementById('template').value;
			const paramsDiv = document.getElementById('templateParams');
			paramsDiv.innerHTML = '';
			
			if (!templateName) {
				return;
			}
			
			const template = templates.find(t => t.name === templateName);
			if (!template) return;
			
			// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
			if (templateName === 'auth') {
				paramsDiv.innerHTML = `
					<label>–¢–∏–ø —Ç–µ—Å—Ç–∞:</label>
					<select id="authType" style="width: 100%; margin-bottom: 10px;">
						<option value="positive">–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–π (—É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥)</option>
						<option value="negative_password">–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π (–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å)</option>
						<option value="negative_validation">–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è)</option>
					</select>
					<label>URL –ª–æ–≥–∏–Ω–∞:</label>
					<input id="authLoginUrl" placeholder="/login" style="width: 100%; margin-bottom: 10px;"/>
					<label>Email:</label>
					<input id="authEmail" placeholder="user@example.com" style="width: 100%; margin-bottom: 10px;"/>
					<label>–ü–∞—Ä–æ–ª—å:</label>
					<input id="authPassword" placeholder="Passw0rd!" style="width: 100%; margin-bottom: 10px;"/>
					<label>URL —É—Å–ø–µ—Ö–∞:</label>
					<input id="authSuccessUrl" placeholder="/dashboard" style="width: 100%;"/>
				`;
			} else if (templateName === 'form') {
				paramsDiv.innerHTML = `
					<label>–¢–∏–ø —Ç–µ—Å—Ç–∞:</label>
					<select id="formType" style="width: 100%; margin-bottom: 10px;">
						<option value="positive">–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–π (—É—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞)</option>
						<option value="negative">–ù–µ–≥–∞—Ç–∏–≤–Ω—ã–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è)</option>
					</select>
					<label>URL —Ñ–æ—Ä–º—ã:</label>
					<input id="formUrl" placeholder="/form" style="width: 100%; margin-bottom: 10px;"/>
					<label>–ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:</label>
					<input id="formSubmit" placeholder="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" style="width: 100%;"/>
				`;
			} else if (templateName === 'list') {
				paramsDiv.innerHTML = `
					<label>–¢–∏–ø —Ç–µ—Å—Ç–∞:</label>
					<select id="listType" style="width: 100%; margin-bottom: 10px;">
						<option value="display">–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ</option>
						<option value="filter">–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è</option>
						<option value="sort">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</option>
						<option value="pagination">–ü–∞–≥–∏–Ω–∞—Ü–∏—è</option>
					</select>
					<label>URL —Å–ø–∏—Å–∫–∞:</label>
					<input id="listUrl" placeholder="/list" style="width: 100%; margin-bottom: 10px;"/>
					<label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:</label>
					<input id="listCount" type="number" value="10" style="width: 100%;"/>
				`;
			} else if (templateName === 'crud') {
				paramsDiv.innerHTML = `
					<label>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:</label>
					<select id="crudType" style="width: 100%; margin-bottom: 10px;">
						<option value="create">–°–æ–∑–¥–∞–Ω–∏–µ</option>
						<option value="read">–ß—Ç–µ–Ω–∏–µ</option>
						<option value="update">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</option>
						<option value="delete">–£–¥–∞–ª–µ–Ω–∏–µ</option>
					</select>
					<label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏:</label>
					<input id="crudEntity" placeholder="—ç–ª–µ–º–µ–Ω—Ç" style="width: 100%; margin-bottom: 10px;"/>
					<label>–ë–∞–∑–æ–≤—ã–π URL:</label>
					<input id="crudUrl" placeholder="/items" style="width: 100%;"/>
				`;
			}
		}
		
		async function postJson(url, body) {
			try {
				const res = await fetch(API_BASE + url, {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify(body)
				});
				if (!res.ok) {
					let errorText = await res.text();
					try {
						const errorJson = JSON.parse(errorText);
						errorText = errorJson.detail || errorText;
					} catch (e) {}
					throw new Error(errorText);
				}
				return res.json();
			} catch (error) {
				// –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º alert –∑–¥–µ—Å—å, –ø—É—Å—Ç—å –≤—ã–∑—ã–≤–∞—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ—à–∞–µ—Ç
				throw error;
			}
		}
		
		function showAlert(message, type = 'success') {
			const alert = document.createElement('div');
			alert.className = 'alert';
			alert.style.borderColor = type === 'error' ? '#ff0066' : '#00ff88';
			alert.style.color = type === 'error' ? '#ff0066' : '#00ff88';
			alert.textContent = message;
			document.body.insertBefore(alert, document.body.firstChild);
			setTimeout(() => alert.remove(), 5000);
		}
		
		async function generateCases() {
			const description = document.getElementById('desc').value.trim();
			if (!description) {
				showAlert('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏—á–∏', 'error');
				return;
			}
			const provider = document.getElementById('aiProvider').value || null;
			const model = document.getElementById('aiModel').value.trim() || null;
			const format = document.getElementById('format').value || 'json';
			
			try {
				const payload = {
					description,
					lang: 'ru',
					format: format
				};
				if (provider) payload.ai_provider = provider;
				if (model) payload.ai_model = model;
				
				const res = await postJson('/generate/test-cases', payload);
				const list = document.getElementById('cases');
				list.innerHTML = '';
				
				if (format === 'markdown' && res.markdown) {
					const li = document.createElement('li');
					li.innerHTML = `<pre style="background: rgba(0,0,0,0.5); padding: 15px; border-radius: 5px;">${res.markdown.replace(/\n/g, '<br/>')}</pre>`;
					list.appendChild(li);
				} else {
					res.test_cases.forEach((c, i) => {
						const li = document.createElement('li');
						li.innerHTML = `
							<strong>${c.title}</strong><br/>
							<span style="color: #00d4ff;">–®–∞–≥–∏:</span><br/>
							${c.steps.map(s => `‚Ä¢ ${s}`).join('<br/>')}<br/>
							<em>–û–∂–∏–¥–∞–µ–º–æ:</em> ${c.expected}
							<br/><button onclick='window.fillCase(${JSON.stringify(c).replaceAll("'", "\\'")})'>üîß –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
						`;
						list.appendChild(li);
					});
				}
				showAlert(`–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${res.test_cases.length} —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤`);
			} catch (error) {
				console.error(error);
				showAlert('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ' + (error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
			}
		}
		
		window.fillCase = function (c) {
			document.getElementById('title').value = c.title;
			document.getElementById('steps').value = c.steps.join('\n');
			document.getElementById('expected').value = c.expected;
		}
		
		async function generateCode() {
			const templateName = document.getElementById('template').value;
			let test_case = null;
			let template_params = null;
			
			// –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —à–∞–±–ª–æ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
			if (templateName) {
				template_params = {};
				if (templateName === 'auth') {
					template_params = {
						type: document.getElementById('authType').value,
						login_url: document.getElementById('authLoginUrl').value || '/login',
						email: document.getElementById('authEmail').value || 'user@example.com',
						password: document.getElementById('authPassword').value || 'Passw0rd!',
						success_url: document.getElementById('authSuccessUrl').value || '/dashboard'
					};
				} else if (templateName === 'form') {
					template_params = {
						type: document.getElementById('formType').value,
						form_url: document.getElementById('formUrl').value || '/form',
						submit_button: document.getElementById('formSubmit').value || '–û—Ç–ø—Ä–∞–≤–∏—Ç—å',
						fields: [{name: '–ø–æ–ª–µ', value: '–∑–Ω–∞—á–µ–Ω–∏–µ', required: true}]
					};
				} else if (templateName === 'list') {
					template_params = {
						type: document.getElementById('listType').value,
						list_url: document.getElementById('listUrl').value || '/list',
						item_count: parseInt(document.getElementById('listCount').value) || 10,
						filter_value: 'test'
					};
				} else if (templateName === 'crud') {
					template_params = {
						type: document.getElementById('crudType').value,
						entity_name: document.getElementById('crudEntity').value || '—ç–ª–µ–º–µ–Ω—Ç',
						base_url: document.getElementById('crudUrl').value || '/items'
					};
				}
			} else {
				// –†—É—á–Ω–æ–π –≤–≤–æ–¥
				test_case = {
					title: document.getElementById('title').value,
					steps: document.getElementById('steps').value.split('\n').filter(Boolean),
					expected: document.getElementById('expected').value
				};
				if (!test_case.title || !test_case.steps.length) {
					showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —à–∞–≥–∏ —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω', 'error');
					return;
				}
			}
			
			const language = document.getElementById('lang').value;
			const base_url = document.getElementById('baseurl').value || null;
			const provider = document.getElementById('codeAiProvider').value || null;
			const model = document.getElementById('codeAiModel').value.trim() || null;
			
			try {
				const payload = { language, base_url };
				if (test_case) payload.test_case = test_case;
				if (templateName) {
					payload.template = templateName;
					payload.template_params = template_params;
				}
				if (provider) payload.ai_provider = provider;
				if (model) payload.ai_model = model;
				
				const res = await postJson('/generate/test-code', payload);
				document.getElementById('code').value = res.code;
				showAlert('–ö–æ–¥ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω');
			} catch (error) {
				console.error(error);
				showAlert('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞: ' + (error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
			}
		}
		
		async function reviewCode() {
			const code = document.getElementById('code').value;
			if (!code.trim()) {
				showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞', 'error');
				return;
			}
			try {
				const res = await postJson('/review/test', { code });
				document.getElementById('review').textContent = JSON.stringify(res, null, 2);
				showAlert('–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω');
			} catch (error) {
				console.error(error);
				showAlert('–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: ' + (error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
			}
		}
		
		async function saveLocal() {
			const path = document.getElementById('path').value;
			const content = document.getElementById('code').value;
			if (!path || !content) {
				showAlert('–£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∏ –∫–æ–¥ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
				return;
			}
			try {
				const res = await postJson('/save/local', { relative_path: path, content });
				showAlert('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: ' + res.path);
			} catch (error) {
				console.error(error);
				showAlert('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + (error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
			}
		}
		
		async function genDemo() {
			const description = document.getElementById('desc').value.trim();
			if (!description) {
				showAlert('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –¥–µ–º–æ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', 'error');
				return;
			}
			const out_dir = document.getElementById('demoOut').value || 'demo_app';
			try {
				const res = await postJson('/generate/demo-app', { description, out_dir });
				showAlert('–î–µ–º–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ:\n' + res.saved.join('\n'));
			} catch (error) {
				console.error(error);
				showAlert('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–µ–º–æ: ' + (error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
			}
		}
		
		async function runTests() {
			const kind = document.getElementById('kind').value;
			try {
				const res = await postJson('/tests/run', { kind });
				document.getElementById('review').textContent = JSON.stringify(res, null, 2);
				showAlert('–¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã');
			} catch (error) {
				console.error(error);
				showAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤: ' + (error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
			}
		}
		
		async function gitPush() {
			const message = document.getElementById('gitmsg').value || 'chore: generated files';
			try {
				const res = await postJson('/git/push', { message });
				showAlert('–ö–æ–º–º–∏—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: ' + res.commit);
			} catch (error) {
				console.error(error);
				showAlert('–û—à–∏–±–∫–∞ git push: ' + (error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
			}
		}
		
		// –ó–∞–≥—Ä—É–∂–∞–µ–º —à–∞–±–ª–æ–Ω—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
		window.addEventListener('DOMContentLoaded', loadTemplates);
	</script>
</head>
<body>
	<div class="container">
		<header>
			<h1>üîí AI Security Test Assistant</h1>
			<div class="subtitle">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ <span class="status-indicator"></span></div>
		</header>

		<section>
			<h2>üõ°Ô∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h2>
			
			<div class="input-group" style="margin-bottom: 15px;">
				<label style="margin-right: 15px;">–ü—Ä–æ–≤–∞–π–¥–µ—Ä –ò–ò:</label>
				<select id="aiProvider" style="width: auto; margin-right: 20px;">
					<option value="">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∏–∑ env)</option>
					<option value="openai">OpenAI</option>
					<option value="ollama">Ollama</option>
				</select>
				
				<label style="margin-right: 10px;">–ú–æ–¥–µ–ª—å:</label>
				<input id="aiModel" placeholder="gpt-4o-mini –∏–ª–∏ qwen2.5:7b-instruct" style="flex: 1; max-width: 300px;"/>
			</div>
			
			<div class="input-group" style="margin-bottom: 15px;">
				<label style="margin-right: 15px;">–§–æ—Ä–º–∞—Ç:</label>
				<select id="format" style="width: auto;">
					<option value="json">JSON</option>
					<option value="markdown">Markdown</option>
				</select>
			</div>
			
			<label>–û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</label>
			<textarea id="desc" placeholder="–û–ø–∏—à–∏—Ç–µ —Ñ–∏—á—É –∏–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è..."></textarea>
			<button onclick="generateCases()">‚ö° –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç-–∫–µ–π—Å—ã</button>
			<ol id="cases"></ol>
		</section>

		<hr/>

		<section>
			<h2>üîß –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞ (Playwright)</h2>
			<div class="row">
				<div>
					<label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞</label>
					<input id="title" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"/>
					
					<label>–®–∞–≥–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ)</label>
					<textarea id="steps" placeholder="1. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞&#10;2. –í–≤–µ—Å—Ç–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ&#10;3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –≤—Ö–æ–¥–∞"></textarea>
					
					<label>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</label>
					<textarea id="expected" style="height:80px" placeholder="–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"></textarea>
					
					<div class="input-group" style="margin-bottom: 15px;">
						<label style="margin-right: 15px;">–®–∞–±–ª–æ–Ω:</label>
						<select id="template" onchange="updateTemplateParams()" style="flex: 1;">
							<option value="">–ó–∞–≥—Ä—É–∑–∫–∞...</option>
						</select>
					</div>
					
					<div id="templateParams" style="margin-bottom: 15px; padding: 15px; background: rgba(0,255,136,0.1); border: 1px solid #00ff88; border-radius: 5px;"></div>
					
					<div class="input-group">
						<label>–Ø–∑—ã–∫:</label>
						<select id="lang">
							<option value="ts">TypeScript</option>
							<option value="js">JavaScript</option>
							<option value="python">Python</option>
						</select>
					</div>
					
					<div class="input-group">
						<label>Base URL:</label>
						<input id="baseurl" placeholder="http://localhost:3000" style="flex: 1;"/>
					</div>
					
					<div class="input-group" style="margin-bottom: 15px;">
						<label style="margin-right: 15px;">–ü—Ä–æ–≤–∞–π–¥–µ—Ä –ò–ò:</label>
						<select id="codeAiProvider" style="width: auto; margin-right: 20px;">
							<option value="">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∏–∑ env)</option>
							<option value="openai">OpenAI</option>
							<option value="ollama">Ollama</option>
						</select>
						
						<label style="margin-right: 10px;">–ú–æ–¥–µ–ª—å:</label>
						<input id="codeAiModel" placeholder="gpt-4o-mini –∏–ª–∏ qwen2.5:7b-instruct" style="flex: 1; max-width: 300px;"/>
					</div>
					
					<button onclick="generateCode()">‚ö° –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
					<button class="secondary" onclick="reviewCode()">üîç AI –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞</button>
					
					<br/><br/>
					
					<div class="input-group">
						<label>Demo out dir:</label>
						<input id="demoOut" value="demo_app" style="flex: 1;"/>
					</div>
					<button onclick="genDemo()">üé® –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
					
					<br/><br/>
					
					<div class="input-group">
						<label>Run tests kind:</label>
						<select id="kind">
							<option value="ts">TypeScript</option>
							<option value="js">JavaScript</option>
							<option value="python">Python</option>
						</select>
					</div>
					<button onclick="runTests()">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã</button>
					
					<br/><br/>
					
					<div class="input-group">
						<label>Git message:</label>
						<input id="gitmsg" value="chore: generated files" style="flex: 1;"/>
					</div>
					<button onclick="gitPush()">üì§ Git push</button>
				</div>
				
				<div>
					<label>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥</label>
					<textarea id="code" style="height:400px; font-family: 'Share Tech Mono', monospace;" placeholder="–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å..."></textarea>
					
					<br/>
					
					<div class="input-group">
						<label>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ –∫–∞–∫:</label>
						<input id="path" placeholder="tests/e2e/generated.spec.ts" value="tests/e2e/generated.spec.ts" style="flex: 1;"/>
					</div>
					<button onclick="saveLocal()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
				</div>
			</div>
		</section>

		<section>
			<h2>üìä AI Review —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h2>
			<pre><code id="review">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</code></pre>
		</section>
	</div>
</body>
</html>
